<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AOD Service Refund Request | AOD ì„œë¹„ìŠ¤ í™˜ë¶ˆ ì‹ ì²­</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ“‹</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #3f3f46;
            --primary-hover: #27272a;
            --error-color: #dc2626;
            --success-color: #16a34a;
            --border-color: #e4e4e7;
            --text-primary: #18181b;
            --text-secondary: #71717a;
            --bg-gray: #fafafa;
            --header-bg: #27272a;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Pretendard', 'Noto Sans JP', 'Inter', 'Segoe UI', sans-serif;
            background: #f4f4f5;
            min-height: 100vh;
            padding: 2rem 1rem;
            color: var(--text-primary);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Language-specific font optimization */
        body[lang="ko"],
        body[lang="ko"] * {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
        }

        body[lang="ja"],
        body[lang="ja"] * {
            font-family: 'Noto Sans JP', 'Hiragino Kaku Gothic ProN', 'Yu Gothic', 'Meiryo', sans-serif;
            letter-spacing: 0.03em;
        }

        body[lang="en"],
        body[lang="en"] * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            overflow: hidden;
        }

        .header {
            background: var(--header-bg);
            color: white;
            padding: 2.5rem 2rem;
            text-align: center;
            border-bottom: 1px solid #52525b;
        }

        .header h1 {
            font-size: 1.75rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            letter-spacing: -0.025em;
        }

        .header p {
            font-size: 0.95rem;
            opacity: 0.8;
            font-weight: 400;
        }

        .content {
            padding: 2rem;
        }

        .notice-box {
            background: #fafaf9;
            border-left: 3px solid #52525b;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border-radius: 6px;
        }

        .notice-box h3 {
            color: var(--text-primary);
            font-size: 1rem;
            margin-bottom: 0.75rem;
            font-weight: 600;
        }

        .notice-box p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.6;
            margin-bottom: 0.5rem;
        }

        .notice-box ul {
            margin-left: 1.5rem;
            margin-top: 0.5rem;
        }

        .notice-box li {
            color: var(--text-secondary);
            font-size: 0.875rem;
            line-height: 1.5;
            margin-bottom: 0.25rem;
        }

        .language-selector {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .lang-btn {
            padding: 0.625rem 1.75rem;
            border: 1.5px solid var(--border-color);
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 500;
            transition: all 0.2s ease;
            color: var(--text-primary);
        }

        .lang-btn:hover {
            border-color: var(--primary-color);
            background: var(--bg-gray);
        }

        .lang-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .form-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .form-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .required {
            color: var(--error-color);
            margin-left: 0.25rem;
        }

        .help-text {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        input[type="text"],
        input[type="email"],
        select,
        textarea {
            width: 100%;
            padding: 0.625rem 0.75rem;
            border: 1.5px solid var(--border-color);
            border-radius: 6px;
            font-size: 0.95rem;
            font-family: inherit;
            transition: all 0.2s ease;
            background: white;
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            background: var(--bg-gray);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .file-upload-area {
            border: 1.5px dashed var(--border-color);
            border-radius: 6px;
            padding: 1.75rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            background: var(--bg-gray);
        }

        .file-upload-area:hover {
            border-color: var(--primary-color);
            background: #fafafa;
        }

        .file-upload-area.dragover {
            border-color: var(--primary-color);
            background: #fafafa;
        }

        input[type="file"] {
            display: none;
        }

        .file-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .file-name {
            margin-top: 1rem;
            padding: 0.5rem;
            background: white;
            border-radius: 6px;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .submit-btn {
            width: 100%;
            padding: 0.875rem;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-top: 2rem;
        }

        .submit-btn:hover {
            background: var(--primary-hover);
        }

        .submit-btn:disabled {
            background: #a1a1aa;
            cursor: not-allowed;
        }

        .error-message {
            color: var(--error-color);
            font-size: 0.875rem;
            margin-top: 0.25rem;
            display: none;
        }

        .success-message {
            background: #f0fdf4;
            border: 1.5px solid var(--success-color);
            color: #166534;
            padding: 1rem;
            border-radius: 6px;
            margin-bottom: 1rem;
            display: none;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 2rem;
        }

        .spinner {
            border: 3px solid var(--border-color);
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 640px) {
            .header h1 {
                font-size: 1.5rem;
            }
            
            .content {
                padding: 1.5rem;
            }
            
            .lang-btn {
                padding: 0.6rem 1.5rem;
                font-size: 0.9rem;
            }
        }

        .optional {
            color: var(--text-secondary);
            font-weight: 400;
            font-size: 0.875rem;
            margin-left: 0.25rem;
        }

        .back-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 0.9rem;
            cursor: pointer;
            padding: 0.5rem 0;
            margin-bottom: 1.5rem;
            transition: color 0.2s ease;
            font-weight: 500;
        }

        .back-btn:hover {
            color: var(--primary-color);
        }

        #languageSelectionScreen {
            padding: 3rem 0;
        }

        #languageSelectionScreen .language-selector {
            margin-bottom: 0;
        }

        #languageSelectionScreen .lang-btn {
            background: var(--header-bg);
            color: white;
            border-color: var(--header-bg);
        }

        #languageSelectionScreen .lang-btn:hover {
            background: var(--primary-hover);
            border-color: var(--primary-hover);
            transform: translateY(-3px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .custom-error {
            color: var(--error-color);
            font-size: 0.875rem;
            margin-top: 0.375rem;
            display: none;
        }

        .input-error {
            border-color: var(--error-color) !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 id="header-title">AOD Service Refund Request</h1>
            <p id="header-subtitle">Please select your language</p>
        </div>

        <div class="content">
            <!-- Initial Language Selection Screen -->
            <div id="languageSelectionScreen">
                <div class="language-selector">
                    <button class="lang-btn" onclick="selectLanguage('en')">English</button>
                    <button class="lang-btn" onclick="selectLanguage('ko')">í•œêµ­ì–´ (Korean)</button>
                    <button class="lang-btn" onclick="selectLanguage('ja')">æ—¥æœ¬èª (Japanese)</button>
                </div>
            </div>

            <!-- Form Content (hidden initially) -->
            <div id="formContent" style="display: none;">
                <!-- Back Button -->
                <button class="back-btn" onclick="goBackToLanguageSelection()">
                    <span id="back-text">â† Back to Language Selection</span>
                </button>

                <!-- Notice Box -->
                <div class="notice-box">
                    <h3 id="notice-title">Privacy Notice</h3>
                    <div id="notice-content-ko" style="display: none;">
                        <p>ë³¸ ì–‘ì‹ì„ í†µí•´ ìˆ˜ì§‘ë˜ëŠ” ê°œì¸ì •ë³´ëŠ” AOD ì„œë¹„ìŠ¤ ì¢…ë£Œì— ë”°ë¥¸ í™˜ë¶ˆ ì²˜ë¦¬ ëª©ì ìœ¼ë¡œë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤.</p>
                        <ul>
                            <li>ìˆ˜ì§‘ í•­ëª©: ì„±ëª…, ê²Œì„ ë‹‰ë„¤ì„, ê³„ì¢Œì •ë³´, ê³„ì¢Œ ì¦ë¹™ì„œë¥˜</li>
                            <li>ì´ìš© ëª©ì : í™˜ë¶ˆê¸ˆ ì†¡ê¸ˆ ì²˜ë¦¬</li>
                            <li>ë³´ìœ  ê¸°ê°„: í™˜ë¶ˆ ì™„ë£Œ í›„ 90ì¼ (ë²•ë ¹ì— ë”°ë¼ í•„ìš”ì‹œ ì—°ì¥ ê°€ëŠ¥)</li>
                            <li>ê·€í•˜ëŠ” ê°œì¸ì •ë³´ ì œê³µì„ ê±°ë¶€í•  ê¶Œë¦¬ê°€ ìˆìœ¼ë‚˜, ì´ ê²½ìš° í™˜ë¶ˆ ì²˜ë¦¬ê°€ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤.</li>
                        </ul>
                    </div>
                    <div id="notice-content-ja" style="display: none;">
                        <p>ã“ã®ç”³è«‹ãƒ•ã‚©ãƒ¼ãƒ ã‚’é€šã˜ã¦åé›†ã•ã‚Œã‚‹å€‹äººæƒ…å ±ã¯ã€AODã‚µãƒ¼ãƒ“ã‚¹çµ‚äº†ã«ä¼´ã†è¿”é‡‘å‡¦ç†ã®ç›®çš„ã§ã®ã¿ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚</p>
                        <ul>
                            <li>åé›†é …ç›®ï¼šæ°åã€ã‚²ãƒ¼ãƒ ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ã€å£åº§æƒ…å ±ã€å£åº§è¨¼æ˜æ›¸é¡</li>
                            <li>åˆ©ç”¨ç›®çš„ï¼šè¿”é‡‘é€é‡‘å‡¦ç†</li>
                            <li>ä¿æœ‰æœŸé–“ï¼šè¿”é‡‘å®Œäº†å¾Œ90æ—¥ï¼ˆæ³•ä»¤ã«ã‚ˆã‚Šå¿…è¦ãªå ´åˆã¯å»¶é•·å¯èƒ½ï¼‰</li>
                            <li>å€‹äººæƒ…å ±ã®æä¾›ã‚’æ‹’å¦ã™ã‚‹æ¨©åˆ©ãŒã‚ã‚Šã¾ã™ãŒã€ãã®å ´åˆè¿”é‡‘å‡¦ç†ãŒã§ãã¾ã›ã‚“ã€‚</li>
                        </ul>
                    </div>
                    <div id="notice-content-en" style="display: none;">
                        <p>Personal information collected through this form will be used solely for processing refunds due to AOD service termination.</p>
                        <ul>
                            <li>Information collected: Name, game nickname, account information, account verification documents</li>
                            <li>Purpose: Processing refund transfers</li>
                            <li>Retention period: 90 days after refund completion (may be extended if required by law)</li>
                            <li>You have the right to refuse to provide personal information, but refunds cannot be processed in such cases.</li>
                        </ul>
                    </div>
                </div>

                <!-- Success Message -->
                <div class="success-message" id="successMessage">
                    <p id="success-text"></p>
                </div>

                <!-- Loading -->
                <div class="loading" id="loadingDiv">
                    <div class="spinner"></div>
                    <p id="loading-text">Processing...</p>
                </div>

                <!-- Form -->
                <form id="refundForm" novalidate>
                <!-- Korean Form -->
                <div class="form-section" id="form-ko">
                    <div class="form-group">
                        <label>ëŒ€í‘œ ìºë¦­í„° ë‹‰ë„¤ì„ <span class="required">*</span></label>
                        <input type="text" name="nickname_ko" required>
                    </div>

                    <div class="form-group">
                        <label>ì‹ ì²­ì ì„±í•¨ <span class="required">*</span></label>
                        <input type="text" name="name_ko" required>
                    </div>

                    <div class="form-group">
                        <label>ì€í–‰ëª… <span class="required">*</span></label>
                        <input type="text" name="bank_name_ko" required>
                    </div>

                    <div class="form-group">
                        <label>SWIFT CODE <span class="required">*</span></label>
                        <input type="text" name="swift_code_ko" required>
                        <div class="help-text">ì˜ˆì‹œ: CZNBKRSEXXX</div>
                    </div>

                    <div class="form-group">
                        <label>ì€í–‰ ì£¼ì†Œ <span class="required">*</span></label>
                        <input type="text" name="bank_address_ko" required>
                    </div>

                    <div class="form-group">
                        <label>ê³„ì¢Œ ë²ˆí˜¸ <span class="required">*</span></label>
                        <input type="text" name="account_number_ko" required>
                    </div>

                    <div class="form-group">
                        <label>ê³„ì¢Œì£¼ëª… <span class="required">*</span></label>
                        <input type="text" name="account_holder_ko" required>
                    </div>

                    <div class="form-group">
                        <label>ì€í–‰ ì „í™”ë²ˆí˜¸ <span class="required">*</span></label>
                        <input type="text" name="bank_phone_ko" required>
                    </div>

                    <div class="form-group">
                        <label>ê³„ì¢Œ ì¦ë¹™ ì„œë¥˜ ì—…ë¡œë“œ <span class="required">*</span></label>
                        <div class="help-text" style="margin-bottom: 0.75rem;">
                            â€¢ ì€í–‰ì—ì„œ ì§ì ‘ ë°œí–‰í•œ ë‚ ì¸ëœ ê³µì‹ ì„œë¥˜<br>
                            â€¢ ì€í–‰ì •ë³´, ê³„ì¢Œì •ë³´ ë“±ì´ ëª…í™•íˆ ê¸°ì¬ëœ ê³µì‹ ì„œë¥˜<br>
                            â€¢ ì€í–‰ ì§ì¸(ë‚ ì¸) í•„ìˆ˜<br>
                            â€¢ í—ˆìš© í˜•ì‹: PDF, JPG, PNG (ìµœëŒ€ 10MB)
                        </div>
                        <div class="file-upload-area" onclick="document.getElementById('file_ko').click()">
                            <div class="file-icon">ğŸ“„</div>
                            <p>í´ë¦­í•˜ì—¬ íŒŒì¼ ì„ íƒ ë˜ëŠ” ë“œë˜ê·¸ ì•¤ ë“œë¡­</p>
                            <div class="file-name" id="fileName_ko" style="display: none;"></div>
                        </div>
                        <input type="file" id="file_ko" name="document_ko" accept=".pdf,.jpg,.jpeg,.png" required>
                    </div>
                </div>

                <!-- Japanese Form -->
                <div class="form-section" id="form-ja">
                    <div class="form-group">
                        <label>ãƒ¡ã‚¤ãƒ³ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ  <span class="required">*</span></label>
                        <input type="text" name="nickname_ja" required>
                    </div>

                    <div class="form-group">
                        <label>é‡‘èæ©Ÿé–¢ã®ç¨®é¡ <span class="required">*</span></label>
                        <select name="institution_type_ja" required>
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="éŠ€è¡Œ">éŠ€è¡Œ</option>
                            <option value="ä¿¡ç”¨é‡‘åº«">ä¿¡ç”¨é‡‘åº«</option>
                            <option value="ä¿¡ç”¨çµ„åˆ">ä¿¡ç”¨çµ„åˆ</option>
                            <option value="åŠ´åƒé‡‘åº«">åŠ´åƒé‡‘åº«ï¼ˆã‚ã†ãã‚“ï¼‰</option>
                            <option value="ã‚†ã†ã¡ã‚‡éŠ€è¡Œ">ã‚†ã†ã¡ã‚‡éŠ€è¡Œ</option>
                            <option value="JAéŠ€è¡Œ">JAãƒãƒ³ã‚¯ï¼ˆè¾²å”ï¼‰</option>
                            <option value="ãƒãƒƒãƒˆéŠ€è¡Œ">ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆéŠ€è¡Œ</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>é‡‘èæ©Ÿé–¢å <span class="required">*</span></label>
                        <input type="text" name="bank_name_ja" required>
                        <div class="help-text">ä¾‹ï¼šä¸‰äº•ä½å‹éŠ€è¡Œã€æ¥½å¤©éŠ€è¡Œãªã©</div>
                    </div>

                    <div class="form-group">
                        <label>é‡‘èæ©Ÿé–¢ã‚³ãƒ¼ãƒ‰ <span class="required">*</span></label>
                        <input type="text" name="bank_code_ja" pattern="[0-9]{4}" required>
                        <div class="help-text">ä¾‹ï¼š0001ï¼ˆ4æ¡ã®åŠè§’æ•°å­—ï¼‰</div>
                    </div>

                    <div class="form-group">
                        <label>æ”¯åº—å <span class="required">*</span></label>
                        <input type="text" name="branch_name_ja" required>
                        <div class="help-text">ä¾‹ï¼šæ¸‹è°·æ”¯åº—</div>
                    </div>

                    <div class="form-group">
                        <label>æ”¯åº—ä½æ‰€ <span class="required">*</span></label>
                        <input type="text" name="branch_address_ja" required>
                    </div>

                    <div class="form-group">
                        <label>æ”¯åº—ã‚³ãƒ¼ãƒ‰ <span class="required">*</span></label>
                        <input type="text" name="branch_code_ja" pattern="[0-9]{3}" required>
                        <div class="help-text">ä¾‹ï¼š001ï¼ˆ3æ¡ã®åŠè§’æ•°å­—ï¼‰</div>
                    </div>

                    <div class="form-group">
                        <label>å£åº§ç¨®é¡ <span class="required">*</span></label>
                        <select name="account_type_ja" required>
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="æ™®é€š">æ™®é€šé é‡‘</option>
                            <option value="å½“åº§">å½“åº§é é‡‘</option>
                            <option value="è²¯è“„">è²¯è“„é é‡‘</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>å£åº§ç•ªå· <span class="required">*</span></label>
                        <input type="text" name="account_number_ja" pattern="[0-9]{7}" required>
                        <div class="help-text">ä¾‹ï¼š1234567ï¼ˆ7æ¡ã®åŠè§’æ•°å­—ï¼‰</div>
                    </div>

                    <div class="form-group">
                        <label>å£åº§åç¾© <span class="required">*</span></label>
                        <input type="text" name="account_holder_ja" required>
                        <div class="help-text">éŠ€è¡Œå£åº§ã®é€šå¸³ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰ç­‰ã‚’åŸºã«<strong>å…¨è§’ã‚«ã‚¿ã‚«ãƒŠ</strong>ã§æ­£ç¢ºã«è¨˜å…¥<br>ä¾‹ï¼šãƒ¤ãƒãƒ€ã€€ã‚¿ãƒ­ã‚¦<br>â€»å£åº§åç¾©ã¨ã”æœ¬äººåãŒç•°ãªã‚‹å ´åˆã€é€é‡‘ãŒã§ããªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</div>
                    </div>

                    <div class="form-group">
                        <label>SWIFTã‚³ãƒ¼ãƒ‰ <span class="required">*</span></label>
                        <input type="text" name="swift_code_ja" required>
                        <div class="help-text">SWIFTã‚³ãƒ¼ãƒ‰ï¼ˆBICã‚³ãƒ¼ãƒ‰ï¼‰ã¯æµ·å¤–é€é‡‘æ™‚ã«å¿…è¦ãªéŠ€è¡Œã®å›½éš›è­˜åˆ¥ç•ªå·ã§ã™ã€‚<br>éŠ€è¡Œãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã‚„ã€Œâ—‹â—‹éŠ€è¡Œ SWIFTã‚³ãƒ¼ãƒ‰ã€ç­‰ã§æ¤œç´¢ã—ã¦ã”ç¢ºèªãã ã•ã„ã€‚</div>
                    </div>

                    <div class="form-group">
                        <label>ç·åˆå£åº§é€šå¸³ã®ã‚³ãƒ”ãƒ¼ã¾ãŸã¯è¨¼æ˜æ›¸ <span class="required">*</span></label>
                        <div class="help-text" style="margin-bottom: 0.75rem;">
                            â€¢ éŠ€è¡Œåï¼ˆä¾‹ï¼šä¸‰è±æ±äº¬UFJéŠ€è¡Œï¼‰ã€æ”¯åº—åã€å£åº§ç•ªå·ã€é é‡‘è€…åã‚’å«ã‚€<br>
                            â€¢ éŠ€è¡Œç›´å°ãŒæŠ¼å°ã•ã‚Œã¦ã„ã‚‹ã“ã¨<br>
                            â€¢ å¯¾å¿œå½¢å¼ï¼šPDFã€JPGã€PNGï¼ˆæœ€å¤§10MBï¼‰
                        </div>
                        <div class="file-upload-area" onclick="document.getElementById('file_ja').click()">
                            <div class="file-icon">ğŸ“„</div>
                            <p>ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã€ã¾ãŸã¯ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—</p>
                            <div class="file-name" id="fileName_ja" style="display: none;"></div>
                        </div>
                        <input type="file" id="file_ja" name="document_ja" accept=".pdf,.jpg,.jpeg,.png" required>
                    </div>
                </div>

                <!-- English Form -->
                <div class="form-section" id="form-en">
                    <div class="form-group">
                        <label>Main Character Nickname <span class="required">*</span></label>
                        <input type="text" name="nickname_en" required>
                    </div>

                    <div class="form-group">
                        <label>Applicant Name <span class="required">*</span></label>
                        <input type="text" name="name_en" required>
                    </div>

                    <div class="form-group">
                        <label>Account Holder Name <span class="required">*</span></label>
                        <input type="text" name="account_holder_en" required>
                    </div>

                    <div class="form-group">
                        <label>Bank Name <span class="required">*</span></label>
                        <input type="text" name="bank_name_en" required>
                    </div>

                    <div class="form-group">
                        <label>SWIFT CODE <span class="required">*</span></label>
                        <input type="text" name="swift_code_en" required>
                        <div class="help-text">Example: CHASUS33</div>
                    </div>

                    <div class="form-group">
                        <label>Bank Address <span class="required">*</span></label>
                        <input type="text" name="bank_address_en" required>
                    </div>

                    <div class="form-group">
                        <label>Account Number <span class="required">*</span></label>
                        <input type="text" name="account_number_en" required>
                    </div>

                    <div class="form-group">
                        <label>Bank Phone Number <span class="required">*</span></label>
                        <input type="text" name="bank_phone_en" required>
                    </div>

                    <div class="form-group">
                        <label>IBAN <span class="optional">(Optional - Required for Europe)</span></label>
                        <input type="text" name="iban_en">
                        <div class="help-text">International Bank Account Number (Required for European banks)</div>
                    </div>

                    <div class="form-group">
                        <label>Proof of Account Details <span class="required">*</span></label>
                        <div class="help-text" style="margin-bottom: 0.75rem;">
                            â€¢ Official document issued directly by the bank with official stamp<br>
                            â€¢ Must clearly show bank information and account details<br>
                            â€¢ Bank's official seal/stamp is required<br>
                            â€¢ Accepted formats: PDF, JPG, PNG (Max 10MB)
                        </div>
                        <div class="file-upload-area" onclick="document.getElementById('file_en').click()">
                            <div class="file-icon">ğŸ“„</div>
                            <p>Click to select file or drag and drop</p>
                            <div class="file-name" id="fileName_en" style="display: none;"></div>
                        </div>
                        <input type="file" id="file_en" name="document_en" accept=".pdf,.jpg,.jpeg,.png" required>
                    </div>
                </div>

                <button type="submit" class="submit-btn" id="submitBtn">
                    <span id="submit-text">Submit</span>
                </button>
            </form>
            </div> <!-- End of formContent -->
        </div>
    </div>

    <script>
        let currentLanguage = null;

        // Do not auto-detect language on page load - show selection screen instead

        function selectLanguage(lang) {
            currentLanguage = lang;
            
            // Set body lang attribute for font optimization
            document.body.setAttribute('lang', lang);
            
            // Hide language selection screen
            document.getElementById('languageSelectionScreen').style.display = 'none';
            
            // Show form content
            document.getElementById('formContent').style.display = 'block';

            // Hide all forms
            document.querySelectorAll('.form-section').forEach(section => {
                section.classList.remove('active');
            });

            // Show selected form
            document.getElementById('form-' + lang).classList.add('active');

            // Update texts based on language
            updateTexts(lang);

            // Show/hide notice content
            document.querySelectorAll('[id^="notice-content-"]').forEach(el => {
                el.style.display = 'none';
            });
            document.getElementById('notice-content-' + lang).style.display = 'block';
        }

        function goBackToLanguageSelection() {
            // Remove body lang attribute
            document.body.removeAttribute('lang');
            
            // Reset header to initial state
            document.getElementById('header-title').textContent = 'AOD Service Refund Request';
            document.getElementById('header-subtitle').textContent = 'Please select your language';
            
            // Show language selection screen
            document.getElementById('languageSelectionScreen').style.display = 'block';
            
            // Hide form content
            document.getElementById('formContent').style.display = 'none';
            
            // Reset form
            document.getElementById('refundForm').reset();
            document.querySelectorAll('.file-name').forEach(el => {
                el.style.display = 'none';
            });
            
            // Hide success message if shown
            document.getElementById('successMessage').style.display = 'none';
            
            currentLanguage = null;
        }

        function updateTexts(lang) {
            const texts = {
                ko: {
                    title: 'AOD ì„œë¹„ìŠ¤ í™˜ë¶ˆ ì‹ ì²­',
                    subtitle: 'App Store ê²°ì œ ìœ ì € ëŒ€ìƒ ê³„ì¢Œ í™˜ë¶ˆ',
                    submit: 'ì œì¶œí•˜ê¸°',
                    loading: 'ì²˜ë¦¬ ì¤‘...',
                    success: 'í™˜ë¶ˆ ì‹ ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤.',
                    noticeTitle: 'ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš© ì•ˆë‚´',
                    back: 'â† ì–¸ì–´ ì„ íƒìœ¼ë¡œ ëŒì•„ê°€ê¸°'
                },
                ja: {
                    title: 'AODã‚µãƒ¼ãƒ“ã‚¹è¿”é‡‘ç”³è«‹',
                    subtitle: 'App Storeæ±ºæ¸ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘å£åº§è¿”é‡‘',
                    submit: 'é€ä¿¡ã™ã‚‹',
                    loading: 'å‡¦ç†ä¸­...',
                    success: 'è¿”é‡‘ç”³è«‹ãŒæ­£å¸¸ã«é€ä¿¡ã•ã‚Œã¾ã—ãŸã€‚',
                    noticeTitle: 'å€‹äººæƒ…å ±ã®åé›†ãƒ»åˆ©ç”¨ã«é–¢ã™ã‚‹ã”æ¡ˆå†…',
                    back: 'â† è¨€èªé¸æŠã«æˆ»ã‚‹'
                },
                en: {
                    title: 'AOD Service Refund Request',
                    subtitle: 'Account Refund for App Store Payment Users',
                    submit: 'Submit',
                    loading: 'Processing...',
                    success: 'Your refund request has been successfully submitted.',
                    noticeTitle: 'Privacy Notice',
                    back: 'â† Back to Language Selection'
                }
            };

            document.getElementById('header-title').textContent = texts[lang].title;
            document.getElementById('header-subtitle').textContent = texts[lang].subtitle;
            document.getElementById('submit-text').textContent = texts[lang].submit;
            document.getElementById('loading-text').textContent = texts[lang].loading;
            document.getElementById('notice-title').textContent = texts[lang].noticeTitle;
            document.getElementById('back-text').textContent = texts[lang].back;
        }

        // File upload handling
        ['ko', 'ja', 'en'].forEach(lang => {
            const fileInput = document.getElementById('file_' + lang);
            const fileName = document.getElementById('fileName_' + lang);
            
            if (fileInput) {
                fileInput.addEventListener('change', function(e) {
                    // Clear error state
                    this.classList.remove('input-error');
                    const errorDiv = this.parentElement.querySelector('.custom-error');
                    if (errorDiv) {
                        errorDiv.style.display = 'none';
                    }
                    
                    if (e.target.files.length > 0) {
                        const file = e.target.files[0];
                        // Check file size (10MB limit)
                        if (file.size > 10 * 1024 * 1024) {
                            alert(currentLanguage === 'ko' ? 'íŒŒì¼ í¬ê¸°ëŠ” 10MBë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.' :
                                  currentLanguage === 'ja' ? 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã¯10MBã‚’è¶…ãˆã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚' :
                                  'File size cannot exceed 10MB.');
                            e.target.value = '';
                            return;
                        }
                        fileName.textContent = file.name;
                        fileName.style.display = 'block';
                    }
                });
            }
        });

        // Clear error state on input
        document.addEventListener('input', function(e) {
            if (e.target.matches('input, select, textarea')) {
                e.target.classList.remove('input-error');
                const errorDiv = e.target.parentElement.querySelector('.custom-error');
                if (errorDiv) {
                    errorDiv.style.display = 'none';
                }
            }
        });

        // Drag and drop handling
        document.querySelectorAll('.file-upload-area').forEach(area => {
            area.addEventListener('dragover', function(e) {
                e.preventDefault();
                this.classList.add('dragover');
            });

            area.addEventListener('dragleave', function() {
                this.classList.remove('dragover');
            });

            area.addEventListener('drop', function(e) {
                e.preventDefault();
                this.classList.remove('dragover');
                
                const lang = this.parentElement.querySelector('input[type="file"]').id.split('_')[1];
                const fileInput = document.getElementById('file_' + lang);
                const fileName = document.getElementById('fileName_' + lang);
                
                if (e.dataTransfer.files.length > 0) {
                    const file = e.dataTransfer.files[0];
                    
                    // Check file size (10MB limit)
                    if (file.size > 10 * 1024 * 1024) {
                        alert(currentLanguage === 'ko' ? 'íŒŒì¼ í¬ê¸°ëŠ” 10MBë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.' :
                              currentLanguage === 'ja' ? 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã¯10MBã‚’è¶…ãˆã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚' :
                              'File size cannot exceed 10MB.');
                        return;
                    }
                    
                    // Check file type
                    const allowedTypes = ['application/pdf', 'image/jpeg', 'image/png'];
                    if (!allowedTypes.includes(file.type)) {
                        alert(currentLanguage === 'ko' ? 'PDF, JPG, PNG íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.' :
                              currentLanguage === 'ja' ? 'PDFã€JPGã€PNGãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¯èƒ½ã§ã™ã€‚' :
                              'Only PDF, JPG, and PNG files are allowed.');
                        return;
                    }
                    
                    const dataTransfer = new DataTransfer();
                    dataTransfer.items.add(file);
                    fileInput.files = dataTransfer.files;
                    
                    fileName.textContent = file.name;
                    fileName.style.display = 'block';
                }
            });
        });

        // Form submission
        document.getElementById('refundForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (!currentLanguage) {
                alert('Please select a language first.');
                return;
            }

            // Clear all previous errors
            document.querySelectorAll('.input-error').forEach(el => el.classList.remove('input-error'));
            document.querySelectorAll('.custom-error').forEach(el => {
                el.style.display = 'none';
                el.textContent = '';
            });

            // Custom validation with language-specific messages
            const activeForm = document.getElementById('form-' + currentLanguage);
            const requiredInputs = activeForm.querySelectorAll('[required]');
            let firstError = null;
            
            const validationMessages = {
                ko: {
                    required: 'ì´ í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.',
                    file: 'íŒŒì¼ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.'
                },
                ja: {
                    required: 'ã“ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚',
                    file: 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚'
                },
                en: {
                    required: 'Please fill out this field.',
                    file: 'Please upload a file.'
                }
            };
            
            requiredInputs.forEach(input => {
                let isInvalid = false;
                let errorMsg = '';
                
                if (input.type === 'file') {
                    if (input.files.length === 0) {
                        isInvalid = true;
                        errorMsg = validationMessages[currentLanguage].file;
                    }
                } else if (!input.value.trim()) {
                    isInvalid = true;
                    errorMsg = validationMessages[currentLanguage].required;
                }
                
                if (isInvalid) {
                    input.classList.add('input-error');
                    
                    // Create or show error message
                    let errorDiv = input.parentElement.querySelector('.custom-error');
                    if (!errorDiv) {
                        errorDiv = document.createElement('div');
                        errorDiv.className = 'custom-error';
                        input.parentElement.appendChild(errorDiv);
                    }
                    errorDiv.textContent = errorMsg;
                    errorDiv.style.display = 'block';
                    
                    if (!firstError) {
                        firstError = input;
                    }
                }
            });
            
            if (firstError) {
                // Scroll to first error
                firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                firstError.focus();
                return;
            }

            // Show loading
            document.getElementById('loadingDiv').style.display = 'block';
            document.getElementById('submitBtn').disabled = true;

            // Prepare form data as JSON
            const formDataObj = {
                language: currentLanguage,
                timestamp: new Date().toISOString()
            };

            // Get all inputs from the active form
            const inputs = activeForm.querySelectorAll('input, select, textarea');
            
            // Handle file upload - convert to base64
            let fileData = null;
            for (const input of inputs) {
                if (input.type === 'file' && input.files.length > 0) {
                    const file = input.files[0];
                    try {
                        const base64 = await fileToBase64(file);
                        fileData = {
                            name: file.name,
                            type: file.type,
                            data: base64
                        };
                    } catch (error) {
                        console.error('File conversion error:', error);
                    }
                } else if (input.type !== 'file') {
                    formDataObj[input.name] = input.value;
                }
            }
            
            if (fileData) {
                formDataObj.fileData = fileData;
            }

            const scriptURL = 'https://script.google.com/macros/s/AKfycbwaUqnhsK5TI2otZ3N9ytbsYiKpyo3z77LgU9ZJEdafTDx7q_XG-TsUIhE5aXDqcBBUhg/exec';

            // Create hidden iframe for submission (to avoid CORS issues)
            const iframe = document.createElement('iframe');
            iframe.style.display = 'none';
            iframe.name = 'hidden_iframe';
            document.body.appendChild(iframe);
            
            // Create temporary form for submission
            const tempForm = document.createElement('form');
            tempForm.method = 'POST';
            tempForm.action = scriptURL;
            tempForm.target = 'hidden_iframe';
            
            // Add all data as hidden inputs
            for (const key in formDataObj) {
                if (key === 'fileData') {
                    // Add file data as separate fields
                    const fileInput1 = document.createElement('input');
                    fileInput1.type = 'hidden';
                    fileInput1.name = 'fileName';
                    fileInput1.value = formDataObj.fileData.name;
                    tempForm.appendChild(fileInput1);
                    
                    const fileInput2 = document.createElement('input');
                    fileInput2.type = 'hidden';
                    fileInput2.name = 'fileType';
                    fileInput2.value = formDataObj.fileData.type;
                    tempForm.appendChild(fileInput2);
                    
                    const fileInput3 = document.createElement('input');
                    fileInput3.type = 'hidden';
                    fileInput3.name = 'fileData';
                    fileInput3.value = formDataObj.fileData.data;
                    tempForm.appendChild(fileInput3);
                } else {
                    const input = document.createElement('input');
                    input.type = 'hidden';
                    input.name = key;
                    input.value = formDataObj[key];
                    tempForm.appendChild(input);
                }
            }
            
            document.body.appendChild(tempForm);
            
            // Submit form
            tempForm.submit();
            
            // Wait a bit then show success (since we can't get response with iframe)
            setTimeout(() => {
                // Hide loading
                document.getElementById('loadingDiv').style.display = 'none';
                document.getElementById('submitBtn').disabled = false;

                // Show success message
                const successMsg = document.getElementById('successMessage');
                const successText = document.getElementById('success-text');
                
                if (currentLanguage === 'ko') {
                    successText.textContent = 'í™˜ë¶ˆ ì‹ ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤. ê²€í†  í›„ ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.';
                } else if (currentLanguage === 'ja') {
                    successText.textContent = 'è¿”é‡‘ç”³è«‹ãŒæ­£å¸¸ã«é€ä¿¡ã•ã‚Œã¾ã—ãŸã€‚ç¢ºèªå¾Œã€ã”é€£çµ¡ã„ãŸã—ã¾ã™ã€‚';
                } else {
                    successText.textContent = 'Your refund request has been successfully submitted. We will contact you after review.';
                }
                
                successMsg.style.display = 'block';

                // Reset form
                document.getElementById('refundForm').reset();
                document.querySelectorAll('.file-name').forEach(el => {
                    el.style.display = 'none';
                });

                // Clean up
                document.body.removeChild(tempForm);
                document.body.removeChild(iframe);

                // Scroll to success message
                successMsg.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 2000);
        });

        // Helper function to convert file to base64
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => {
                    const base64 = reader.result.split(',')[1];
                    resolve(base64);
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }
    </script>
</body>
</html>
